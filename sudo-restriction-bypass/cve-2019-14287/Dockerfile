FROM debian:buster-slim

ARG START_POINT=/app

RUN  apt update \
  && apt install -y vim less openssl wget \
  && useradd -m -s /bin/bash -p `echo -n 'test' | openssl passwd -6 -stdin` test \
  && wget --quiet http://snapshot.debian.org/archive/debian/20190112T211025Z/pool/main/s/sudo/sudo_1.8.27-1_amd64.deb \
  && apt install -y --allow-downgrades ./sudo_1.8.27-1_amd64.deb

COPY data $START_POINT
COPY data/cve-2019-14287 /etc/sudoers.d/
WORKDIR $START_POINT

USER test
ENTRYPOINT ["/bin/sh", "/app/run.sh"]
CMD ["run"]
