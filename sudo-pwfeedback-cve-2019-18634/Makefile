net := sudo-pwfeedback-cve-2019-18634
srv := sudo-server

build:
	-docker network remove $(net)
	docker network create $(net)
	docker build -t $(srv) $(srv)/.

run_opts := --rm -it --network $(net) --security-opt=no-new-privileges:false

drun := docker run $(run_opts) --name $(srv) $(srv)

run:
	$(drun)
	-docker network remove $(net)

clean:
	-docker network remove $(net)
	-docker container rm $(srv)
	-docker image rm $(srv)
